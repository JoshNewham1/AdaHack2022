<!DOCTYPE html>
<html>
  <head>
    <title>Twitter Word Cloud</title>
    <script src="https://cdn.anychart.com/releases/v8/js/anychart-base.min.js"></script>
    <script src="https://cdn.anychart.com/releases/v8/js/anychart-tag-cloud.min.js"></script>
  </head>
  <body>
    <form style="padding-top: 40px; padding-left: 20px" id="searchForm">
      <input
        type="text"
        id="searchWord"
        name="searchWord"
        pattern="[A-za-z0-9 ]+"
        placeholder="Tweet Search"
      />
    </form>
    <div id="container"></div>
  </body>
</html>
<style>
  html,
  body,
  #container {
    width: 100%;
    height: 100%;
    margin: 0;
    padding: 0;
  }
  #searchWord {
    width: 500px;
    height: 45px;
    font-size: large;
  }
</style>

<script>
  function formSubmit(event) {
    event.preventDefault();
    var input = document.getElementById("searchWord").value;
    fetch("http://localhost:5000/getWordMap?word=" + input)
      .then((response) => response.json())
      .then((data) => {
        document.getElementById("container").innerHTML = "";
        // create a word cloud
        const wordCloud = anychart.tagCloud(data?.words);
        // set an array of angles at which the words will be laid out
        wordCloud.angles([0]);

        // display the word cloud
        wordCloud.container("container");
        wordCloud.draw();

        // create a bar chart
        const barChart = anychart.bar();
        // Convert JSON object {0: 100, 0.2: 200, ...} to 2D array [[0, 100], [0.2, 200]]
        const dataArray = Object.keys(data?.sentiments).map((k) => [
          k,
          data?.sentiments[k],
        ]);
        const series = barChart.bar(dataArray);
        barChart.container("container");
        barChart.draw();
      })
      .catch(() => {
        document.getElementById("container").innerHTML = "";
        alert("Could not find any tweets with that search input...");
      });
  }
  document
    .getElementById("searchForm")
    .addEventListener("submit", formSubmit, false);
</script>
